<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>E2E</title>
   <link href="../src/main/css/style.css" rel="stylesheet">
  </head>
  <body>
    <div id="e2e"></div>
   <script src="../build/vis.js"></script>
   <script src="../node_modules/d3/build/d3.js"></script>

   <script>
     

    var width = window.innerWidth*0.8;
    var height = window.innerHeight*0.8;

    d3.select("#resetModel").on("click",function(){
       initialize()
    })

    function extensionFactory(node,nodeHash){
        if(node.data.id==='service3' && !nodeHash[extensionId]){
          return extensionNode;
        }
      return null;
    }

   function createModel(options = { nodesize: 10, width: 600, height: 600 }){

     const nodesize=options.nodesize;
     const width = options.width;
     const height = options.height;

     var newHierarchyReferences = function(d){
       d.id = 'p'+d.id;
       if(d.parent!=="null")
         d.parent = 'p'+d.parent;
     }
     var newMapReferences = function(r){
       r.source = 'p'+r.source;
       r.target = 'p'+r.target;
     }

     var newCrossStackReferences = function(r){
       if(r.type==='Dependency'){
         r.source = r.source;
         r.target = 'p'+r.target;
       }
     }

     var serviceData =[[
     {
       "type": "Customer Facing Service Catalogue",
       "id": "{CA66B085-4A11-486e-B043-2525BAC3F00C}",
       "name": "Enterprise Service Catalogue",
       "description": "A catalogue of customer facing services provided by the entire organization.\r\n",
       "min": 0,
       "parent": "null",
       "level": "3",
       "project": "ServiceCatalogue"
     },
     {
       "type": "Customer Facing Service Specification Type",
       "id": "{3DDA929B-1DC8-4fe5-B91F-1A8600465797}",
       "name": "Enterprise External User Connectivity",
       "description": "",
       "min": 1,
       "parent": "{CA66B085-4A11-486e-B043-2525BAC3F00C}"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{BF49AD93-7332-460d-9D6D-24936469649C}",
       "name": "TollFree",
       "description": "Service to provided free to call numbers.\r\n\r\nAn organizations customer can reach an organization without encurring costs.\r\n",
       "min": 2,
       "parent": "{3DDA929B-1DC8-4fe5-B91F-1A8600465797}",
       "pageId": "63918769",
       "label": "CustomerFacingServiceTollFree"
     },
     {
       "type": "Customer Facing Service Specification Type",
       "id": "{A62BD9D4-E2C9-42a6-A402-4C82F44EB72A}",
       "name": "Site Connectivity",
       "description": "",
       "min": 1,
       "parent": "{CA66B085-4A11-486e-B043-2525BAC3F00C}"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{27DF6C8A-D97E-4724-A902-F4C94A239308}",
       "name": "WAN",
       "description": "IP connectivity from customer site to other sites via routing and access services.\r\n\r\n\r\nA WAN has children of  Fixed Access  or Site Mobile Access , LAN , and WAN Interconnect which are resources with respect to the WAN and must be established prior to the WAN.",
       "min": 2,
       "parent": "{A62BD9D4-E2C9-42a6-A402-4C82F44EB72A}",
       "pageId": "63918750",
       "label": "CustomerFacingServiceWAN"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{59F49E48-5890-49a5-A9B9-046A1E2724C3}",
       "name": "Fixed Access",
       "description": "Connectivity from a site LAN to a central routing function.\r\n\r\nIncludes IAD, in the case of PD25 the options are 1Gbps or 10Bgps port",
       "min": 2,
       "parent": "{A62BD9D4-E2C9-42a6-A402-4C82F44EB72A}",
       "pageId": "63918717",
       "label": "CustomerFacingServiceFixedAccess"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{DC6945C3-C936-425d-9F31-DAEC8B66E27D}",
       "name": "SIP Connectivity",
       "description": "Providing  SIP interconnect/trunking functions from a customers site.",
       "min": 2,
       "parent": "{A62BD9D4-E2C9-42a6-A402-4C82F44EB72A}",
       "pageId": "63918765",
       "label": "CustomerFacingServiceSIPConnectivity"
     },
     {
       "type": "Customer Facing Service Specification Type",
       "id": "{966988BE-2DF9-45ea-BDFC-71EDAF21DDA2}",
       "name": "Enterprise Connectivity",
       "description": "",
       "min": 1,
       "parent": "{CA66B085-4A11-486e-B043-2525BAC3F00C}"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{CBFE96D7-BEDB-455b-AAD2-A6844E40AF67}",
       "name": "UPS",
       "description": "Service to provide subscription for universal power supplies.",
       "min": 2,
       "parent": "{966988BE-2DF9-45ea-BDFC-71EDAF21DDA2}",
       "pageId": "63918755",
       "label": "CustomerFacingServiceUPS"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{A77C29D4-3CA3-47e8-85F0-1695511F3DA6}",
       "name": "Encrypted Access",
       "description": "Establishment of secure IP connectivity between 2 sites.\r\n\r\n\r\nConfiguration applied onto MNS routers, together with DC Head-End Encryption Routers. \\nAlso provides Virtual Encryption Domain (VDC) for WiFi devices &amp; LAN Ports.\r\n\r\nEvery customer can have an access ",
       "min": 2,
       "parent": "{966988BE-2DF9-45ea-BDFC-71EDAF21DDA2}",
       "pageId": "63918753",
       "label": "CustomerFacingServiceEncryptedAccess"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{CF4CAD09-E060-474d-8B00-B703F9950A3B}",
       "name": "WAN Interconnect",
       "description": "Routing of IP connectivity between different networks\r\n\r\nPIP VRF Can be GNET or LNO",
       "min": 2,
       "parent": "{966988BE-2DF9-45ea-BDFC-71EDAF21DDA2}",
       "pageId": "63918760",
       "label": "CustomerFacingServiceWANCore"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{18789987-FC17-4b7c-9D0F-438C3482B0D0}",
       "name": "Facilities and Equipment Management",
       "description": "Services including structured cable installation,  rack management.\r\n",
       "min": 2,
       "parent": "{966988BE-2DF9-45ea-BDFC-71EDAF21DDA2}",
       "pageId": "63918789",
       "label": "CustomerFacingServiceFaciliatesandEquipmentManagement"
     },
     {
       "type": "Customer Facing Service Specification Type",
       "id": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "name": "User Connectivity",
       "description": "",
       "min": 1,
       "parent": "{CA66B085-4A11-486e-B043-2525BAC3F00C}"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{E6509D6C-B00B-49fa-9FC7-202885C38C8F}",
       "name": "WiFi",
       "description": "Services to provide access to a sites network over the WIFI protocol.",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "63918802",
       "label": "CustomerFacingServiceWiFi"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{C104EA20-0BBB-4247-9367-3B75C6A13766}",
       "name": "Telephony",
       "description": "Connecting multiple parties in a voice conversation.\r\n\r\nThere is a MSISDN (phone number) assigned to this service.",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "63918735",
       "label": "CustomerFacingServiceTelephony"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{76460DE4-5689-4f72-B722-C897B3B077E0}",
       "name": "SMS",
       "description": "Service which allows customer to send Short Message Service messages in bulk to groups, as reminders or through applications.",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "63918738",
       "label": "CustomerFacingServiceSMS"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "name": "UC Access",
       "description": "Base Unified Communications Account service which gives access to the unified communications platform and self service portal.",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "64858125",
       "label": "CustomerFacingServiceUCAccess"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{436F66D2-17F7-4b79-8FDC-5F27323299DC}",
       "name": "Sharing",
       "description": "A service that allows remote access and remote collaboration on a parties device.",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "63918737",
       "label": "CustomerFacingServiceSharing"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{D140E603-2292-460c-A3AD-28C618B3CA2A}",
       "name": "Presence",
       "description": " A service that provides a status indicator that conveys ability and willingness of a potential communication partner.",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "63918739",
       "label": "CustomerFacingServicePresence"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{7DD6D90F-6732-4709-88A3-BCAD6E375ACA}",
       "name": "LAN",
       "description": "IP connectivity among customer equipment at a site.\r\n\r\nService includes the ability to manage the configuration of LAN switches.\r\n\r\nSFP's will be required for each order.\r\n",
       "min": 2,
       "parent": "{D288C560-FEB3-4064-9049-CCBBB11BAD8B}",
       "pageId": "63918796",
       "label": "CustomerFacingServiceLAN"
     },
     {
       "type": "Customer Facing Service Specification Type",
       "id": "{38169920-DF55-4c3d-8F33-18F47BA58F28}",
       "name": "Mobile Telephony",
       "description": "",
       "min": 1,
       "parent": "{CA66B085-4A11-486e-B043-2525BAC3F00C}"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{AD56CCBD-15E4-4c1e-90D2-CFB4AAF6F581}",
       "name": "Mobile Service",
       "description": "Service providing access to wireless mobile telecommunications.",
       "min": 2,
       "parent": "{38169920-DF55-4c3d-8F33-18F47BA58F28}",
       "mobiledata_status": "enabled,blocked,suspended",
       "pageId": "63918781",
       "label": "CustomerFacingServiceMobileService"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{9F04C680-3B4F-4fc8-8075-19023892E28C}",
       "name": "Mobile Device Management",
       "description": "Services related to the administration of mobile devices.\r\nProvided on the Mobile Device Management (MDM) platform\r\nApparently this service is delivered through AirWatch\r\nThis is currently known as Vodafone Secure Device Management (VSDM)",
       "min": 2,
       "parent": "{38169920-DF55-4c3d-8F33-18F47BA58F28}",
       "pageId": "63918784",
       "label": "CustomerFacingServiceMobileDeviceManagement"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{D9421060-DFA5-4675-B7F9-21A0CFDB3109}",
       "name": "Site Mobile Access Connectivity",
       "description": "IP Connectivity from a mobile device to a centralized routing function.  ",
       "min": 2,
       "parent": "{38169920-DF55-4c3d-8F33-18F47BA58F28}",
       "status": "enabled,blocked,out of credit",
       "pageId": "63918756",
       "label": "CustomerFacingServiceMobileAccess"
     },
     {
       "type": "Customer Facing Service Specification",
       "id": "{FD57AFFC-EE6E-478a-A1A2-264C873CF975}",
       "name": "Mobile Service Usage Management",
       "description": "Service which allows a group of customer users to share data usage.\r\n\r\ne.g. Red Share\r\n\r\nfor CSS address voices,sms and data usage.\r\n\r\n",
       "min": 2,
       "parent": "{38169920-DF55-4c3d-8F33-18F47BA58F28}",
       "pageId": "63918758",
       "label": "CustomerFacingServiceUsageManagement"
     }
   ]
   ,][0]
     var constraintsData =[[
     {
       "source": "{1D4CEFAF-95BC-47c4-A192-75EE5FB13D46}",
       "sourcename": "UFBAvailable",
       "sourceclass": "ServiceConstraint",
       "target": "{361005C0-FE79-4d18-A294-ED4131214A18}",
       "targetname": "Auckland",
       "targetclass": "Customer Location",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{1D4CEFAF-95BC-47c4-A192-75EE5FB13D46}",
       "sourcename": "UFBAvailable",
       "sourceclass": "ServiceConstraint",
       "target": "{E8463179-BF7B-47f8-9430-03BD33DCE887}",
       "targetname": "Wellington",
       "targetclass": "Customer Location",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{1D4CEFAF-95BC-47c4-A192-75EE5FB13D46}",
       "sourcename": "UFBAvailable",
       "sourceclass": "ServiceConstraint",
       "target": "{59F49E48-5890-49a5-A9B9-046A1E2724C3}",
       "targetname": "Fixed Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{1D4CEFAF-95BC-47c4-A192-75EE5FB13D46}",
       "sourcename": "UFBAvailable",
       "sourceclass": "ServiceConstraint",
       "target": "{EF3C711F-3FE1-4214-A181-5DAD7B84F868}",
       "targetname": "Christchurch",
       "targetclass": "Customer Location",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{C104EA20-0BBB-4247-9367-3B75C6A13766}",
       "targetname": "Telephony",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{8C3BF873-9029-4d67-8332-EC12E77A5B1B}",
       "targetname": "meetingroom1@customer.co.nz",
       "targetclass": "userId",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{CDBA6ED3-EBC5-46de-9942-882E39DCDFC8}",
       "targetname": "jean.jones@customer.co.nz",
       "targetclass": "userId",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{9CBBB426-2EBF-4fad-A85F-93B0E5AEF3FD}",
       "targetname": "steve@supplier.co.nz",
       "targetclass": "userId",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "targetname": "UC Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{EB9BDEAE-28D1-4a87-8013-9986B7AA0CE7}",
       "targetname": "jim.smith@supplier.co.nz",
       "targetclass": "userId",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{436F66D2-17F7-4b79-8FDC-5F27323299DC}",
       "targetname": "Sharing",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{616D629F-2594-4ca9-AE71-16542DCEDFB4}",
       "sourcename": "HumaneComputerInterface",
       "sourceclass": "ServiceConstraint",
       "target": "{D140E603-2292-460c-A3AD-28C618B3CA2A}",
       "targetname": "Presence",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{A60CD7B5-80ED-4c6c-8DD6-CDB8FE60E5D7}",
       "sourcename": "WifiEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{5F71FEB0-85FF-4cf8-8E88-39A82E7196EF}",
       "targetname": "Tablet",
       "targetclass": "IPDevice",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{A60CD7B5-80ED-4c6c-8DD6-CDB8FE60E5D7}",
       "sourcename": "WifiEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{3955217A-79B2-4f47-8CB4-05237F37CDAA}",
       "targetname": "Smart Phone",
       "targetclass": "IPDevice",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{A60CD7B5-80ED-4c6c-8DD6-CDB8FE60E5D7}",
       "sourcename": "WifiEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{E6509D6C-B00B-49fa-9FC7-202885C38C8F}",
       "targetname": "WiFi",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{731AAAE6-F912-426d-98E9-FC527F7E80DD}",
       "sourcename": "LANEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{C53F4E8A-213C-49a9-A4E4-DC0179158382}",
       "targetname": "Huawei  HG659",
       "targetclass": "Resource Facing Service Specification",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{731AAAE6-F912-426d-98E9-FC527F7E80DD}",
       "sourcename": "LANEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{8E0B1593-C775-48cc-9A04-88725F8762AB}",
       "targetname": "Personal Computer",
       "targetclass": "IPDevice",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{731AAAE6-F912-426d-98E9-FC527F7E80DD}",
       "sourcename": "LANEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{1C3765FD-89E8-4eb8-9637-24298738E3CE}",
       "targetname": "Polycom XXXX Phone",
       "targetclass": "IPDevice",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{731AAAE6-F912-426d-98E9-FC527F7E80DD}",
       "sourcename": "LANEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{AC236FBA-1E17-4017-B97D-6485FEB3C50C}",
       "targetname": "IP Phone",
       "targetclass": "IPDevice",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{731AAAE6-F912-426d-98E9-FC527F7E80DD}",
       "sourcename": "LANEnabled",
       "sourceclass": "ServiceConstraint",
       "target": "{7DD6D90F-6732-4709-88A3-BCAD6E375ACA}",
       "targetname": "LAN",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{FEFEBCE3-2EEC-492d-8E41-05D7E7687501}",
       "sourcename": "UFBNotAvailable",
       "sourceclass": "ServiceConstraint",
       "target": "{D0481442-1174-471e-8B55-ADC55D709000}",
       "targetname": "Dunedin",
       "targetclass": "Customer Location",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{FEFEBCE3-2EEC-492d-8E41-05D7E7687501}",
       "sourcename": "UFBNotAvailable",
       "sourceclass": "ServiceConstraint",
       "target": "{D9421060-DFA5-4675-B7F9-21A0CFDB3109}",
       "targetname": "Site Mobile Access Connectivity",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{2EF4E2F8-19DF-4307-84BB-2BFAC219EEFE}",
       "sourcename": "WifiProvider",
       "sourceclass": "ServiceConstraint",
       "target": "{E6509D6C-B00B-49fa-9FC7-202885C38C8F}",
       "targetname": "WiFi",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{2EF4E2F8-19DF-4307-84BB-2BFAC219EEFE}",
       "sourcename": "WifiProvider",
       "sourceclass": "ServiceConstraint",
       "target": "{D73AB04F-26E3-4063-BF04-250AD433B36F}",
       "targetname": "Ruckus SmartZone Controller",
       "targetclass": "Resource Facing Service Specification",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     }
   ]
   ,][0]
     var emergentData =[[
     {
       "source": "{F349E413-ADF6-4085-A1E4-A21006C34964}",
       "sourcename": "SIP End 2 End Connectivity",
       "sourceclass": "ServiceConstraint",
       "target": "{DC6945C3-C936-425d-9F31-DAEC8B66E27D}",
       "targetname": "SIP Connectivity",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     },
     {
       "source": "{F349E413-ADF6-4085-A1E4-A21006C34964}",
       "sourcename": "SIP End 2 End Connectivity",
       "sourceclass": "ServiceConstraint",
       "target": "{DC6945C3-C936-425d-9F31-DAEC8B66E27D}",
       "targetname": "SIP Connectivity",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{A809D1CC-F1C0-497f-95B1-787ED09D8EEA}",
       "sourcename": "Telephony Connectivity",
       "sourceclass": "ServiceConstraint",
       "target": "{C104EA20-0BBB-4247-9367-3B75C6A13766}",
       "targetname": "Telephony",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{A809D1CC-F1C0-497f-95B1-787ED09D8EEA}",
       "sourcename": "Telephony Connectivity",
       "sourceclass": "ServiceConstraint",
       "target": "{C104EA20-0BBB-4247-9367-3B75C6A13766}",
       "targetname": "Telephony",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Association",
       "stereotype": ""
     }
   ]
   ,][0]

     var customerHierarchy =[[
     {
       "type": "Customer",
       "id": "{B8FC179E-6A08-4921-956C-3C5EC433F079}",
       "name": "aCustomer",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "Business Unit",
       "id": "{9909F2AE-4709-4dae-8BD2-3217DB1A2505}",
       "name": "Consumer",
       "description": "",
       "min": 2,
       "parent": "{B8FC179E-6A08-4921-956C-3C5EC433F079}",
       "aka": "CBU"
     },
     {
       "type": "Group",
       "id": "{28354BEF-7549-47db-B4D3-2BB7FB0D4276}",
       "name": "Operations",
       "description": "",
       "min": 3,
       "parent": "{9909F2AE-4709-4dae-8BD2-3217DB1A2505}"
     },
     {
       "type": "userId",
       "id": "{CDBA6ED3-EBC5-46de-9942-882E39DCDFC8}",
       "name": "jean.jones@customer.co.nz",
       "description": "",
       "min": 4,
       "parent": "{28354BEF-7549-47db-B4D3-2BB7FB0D4276}"
     },
     {
       "type": "userId",
       "id": "{8C3BF873-9029-4d67-8332-EC12E77A5B1B}",
       "name": "meetingroom1@customer.co.nz",
       "description": "",
       "min": 4,
       "parent": "{28354BEF-7549-47db-B4D3-2BB7FB0D4276}"
     }
   ]
   ,][0]
     var customerDeviceHierarchy =[[
     {
       "type": "StandardOperatingEnvironment",
       "id": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}",
       "name": "Common Operating Environment",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "IPDevice",
       "id": "{5F71FEB0-85FF-4cf8-8E88-39A82E7196EF}",
       "name": "Tablet",
       "description": "",
       "min": 2,
       "parent": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}"
     },
     {
       "type": "IPDevice",
       "id": "{1C3765FD-89E8-4eb8-9637-24298738E3CE}",
       "name": "Polycom XXXX Phone",
       "description": "",
       "min": 2,
       "parent": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}"
     },
     {
       "type": "IPDevice",
       "id": "{8E0B1593-C775-48cc-9A04-88725F8762AB}",
       "name": "Personal Computer",
       "description": "",
       "min": 2,
       "parent": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}"
     }
   ]
   ,][0]
     var customerCPEHierarchy =[[
     {
       "type": "Resource Facing Service Catalogue",
       "id": "{6146F0AB-0A46-4e13-A730-AC07BBB4BB8D}",
       "name": "Enterprise RFS",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "Resource Facing Service Specification Type",
       "id": "{3B87E9CA-ABD5-4269-BC52-220FCFA50029}",
       "name": "Customer Premise Equipment",
       "description": "",
       "min": 2,
       "parent": "{6146F0AB-0A46-4e13-A730-AC07BBB4BB8D}"
     },
     {
       "type": "Resource Facing Service Specification",
       "id": "{D73AB04F-26E3-4063-BF04-250AD433B36F}",
       "name": "Ruckus SmartZone Controller",
       "description": "SmartZone 100 provides everything needed to rollout an enterprise Wi-Fi network fast.\r\n\r\nA physical controller with multiple 1GbE and 10GbE ports in a rack mountable 1U form factor.\r\n3+1 clustering delivers up to 3,000 APs per cluster.\r\nConnect up to 60,000 clients, and support tunneled or local break-out user traffic.",
       "min": 3,
       "parent": "{3B87E9CA-ABD5-4269-BC52-220FCFA50029}",
       "pageId": "64225509",
       "label": "ResourceFacingServiceRuckusSmartZoneController"
     },
     {
       "type": "Resource Facing Service Specification",
       "id": "{C53F4E8A-213C-49a9-A4E4-DC0179158382}",
       "name": "Huawei  HG659",
       "description": "Vodafone wireless modem\r\n\r\nhttps://www.vodafone.co.nz/cms/documents/wirelessmodem-userguide.pdf",
       "min": 3,
       "parent": "{3B87E9CA-ABD5-4269-BC52-220FCFA50029}"
     }
   ]
   ,][0]
     var customerSiteHierarchy =[[
     {
       "type": "Customer",
       "id": "{B8FC179E-6A08-4921-956C-3C5EC433F079}",
       "name": "aCustomer",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "Customer Location",
       "id": "{361005C0-FE79-4d18-A294-ED4131214A18}",
       "name": "Auckland",
       "description": "",
       "min": 2,
       "parent": "{B8FC179E-6A08-4921-956C-3C5EC433F079}"
     },
     {
       "type": "Customer Location",
       "id": "{E8463179-BF7B-47f8-9430-03BD33DCE887}",
       "name": "Wellington",
       "description": "",
       "min": 2,
       "parent": "{B8FC179E-6A08-4921-956C-3C5EC433F079}"
     }
   ]
   ,][0]
     var customerInterrelationships =[[
     {
       "source": "{27DF6C8A-D97E-4724-A902-F4C94A239308}",
       "sourcename": "WAN",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{D9421060-DFA5-4675-B7F9-21A0CFDB3109}",
       "targetname": "Site Mobile Access Connectivity",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{7DD6D90F-6732-4709-88A3-BCAD6E375ACA}",
       "sourcename": "LAN",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{27DF6C8A-D97E-4724-A902-F4C94A239308}",
       "targetname": "WAN",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{27DF6C8A-D97E-4724-A902-F4C94A239308}",
       "sourcename": "WAN",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{59F49E48-5890-49a5-A9B9-046A1E2724C3}",
       "targetname": "Fixed Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{27DF6C8A-D97E-4724-A902-F4C94A239308}",
       "sourcename": "WAN",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{CF4CAD09-E060-474d-8B00-B703F9950A3B}",
       "targetname": "WAN Interconnect",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{E6509D6C-B00B-49fa-9FC7-202885C38C8F}",
       "sourcename": "WiFi",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{7DD6D90F-6732-4709-88A3-BCAD6E375ACA}",
       "targetname": "LAN",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{DC6945C3-C936-425d-9F31-DAEC8B66E27D}",
       "sourcename": "SIP Connectivity",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{7DD6D90F-6732-4709-88A3-BCAD6E375ACA}",
       "targetname": "LAN",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{AD56CCBD-15E4-4c1e-90D2-CFB4AAF6F581}",
       "sourcename": "Mobile Service",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{CF4CAD09-E060-474d-8B00-B703F9950A3B}",
       "targetname": "WAN Interconnect",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{D140E603-2292-460c-A3AD-28C618B3CA2A}",
       "sourcename": "Presence",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "targetname": "UC Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{D89F8DCE-9B42-42c5-B17F-3A9933CAEF41}",
       "sourcename": "Media Conferencing",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "targetname": "UC Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "sourcename": "UC Access",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{DC6945C3-C936-425d-9F31-DAEC8B66E27D}",
       "targetname": "SIP Connectivity",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{C104EA20-0BBB-4247-9367-3B75C6A13766}",
       "sourcename": "Telephony",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "targetname": "UC Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     },
     {
       "source": "{436F66D2-17F7-4b79-8FDC-5F27323299DC}",
       "sourcename": "Sharing",
       "sourceclass": "Customer Facing Service Specification",
       "target": "{C0775155-E26C-484e-A1CD-87118C3E8718}",
       "targetname": "UC Access",
       "targetclass": "Customer Facing Service Specification",
       "value": "1",
       "type": "Dependency",
       "stereotype": ""
     }
   ]
   ,][0]
     var customerServiceData = serviceData;
     var customerConstraints = constraintsData;

     var partyHierarchy =[[
     {
       "type": "Party",
       "id": "{64B4C39A-6D87-4fe7-91A1-2C9733051B37}",
       "name": "aParty",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "Supplier",
       "id": "{081A1B02-96BF-4417-8D48-0F1D16166AF6}",
       "name": "aSupplier",
       "description": "",
       "min": 2,
       "parent": "{64B4C39A-6D87-4fe7-91A1-2C9733051B37}"
     },
     {
       "type": "userId",
       "id": "{9CBBB426-2EBF-4fad-A85F-93B0E5AEF3FD}",
       "name": "steve@supplier.co.nz",
       "description": "",
       "min": 3,
       "parent": "{081A1B02-96BF-4417-8D48-0F1D16166AF6}"
     },
     {
       "type": "userId",
       "id": "{EB9BDEAE-28D1-4a87-8013-9986B7AA0CE7}",
       "name": "jim.smith@supplier.co.nz",
       "description": "",
       "min": 3,
       "parent": "{081A1B02-96BF-4417-8D48-0F1D16166AF6}"
     }
   ]
   ,][0]
     var partyDeviceHierarchy =[[
     {
       "type": "StandardOperatingEnvironment",
       "id": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}",
       "name": "Common Operating Environment",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "IPDevice",
       "id": "{5F71FEB0-85FF-4cf8-8E88-39A82E7196EF}",
       "name": "Tablet",
       "description": "",
       "min": 2,
       "parent": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}"
     },
     {
       "type": "IPDevice",
       "id": "{1C3765FD-89E8-4eb8-9637-24298738E3CE}",
       "name": "Polycom XXXX Phone",
       "description": "",
       "min": 2,
       "parent": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}"
     },
     {
       "type": "IPDevice",
       "id": "{8E0B1593-C775-48cc-9A04-88725F8762AB}",
       "name": "Personal Computer",
       "description": "",
       "min": 2,
       "parent": "{49D63AC0-DD84-45c1-BC91-3956EC60CBDB}"
     }
   ]
   ,][0]
     var partyCPEHierarchy =[[
     {
       "type": "Resource Facing Service Catalogue",
       "id": "{6146F0AB-0A46-4e13-A730-AC07BBB4BB8D}",
       "name": "Enterprise RFS",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "Resource Facing Service Specification Type",
       "id": "{3B87E9CA-ABD5-4269-BC52-220FCFA50029}",
       "name": "Customer Premise Equipment",
       "description": "",
       "min": 2,
       "parent": "{6146F0AB-0A46-4e13-A730-AC07BBB4BB8D}"
     },
     {
       "type": "Resource Facing Service Specification",
       "id": "{D73AB04F-26E3-4063-BF04-250AD433B36F}",
       "name": "Ruckus SmartZone Controller",
       "description": "SmartZone 100 provides everything needed to rollout an enterprise Wi-Fi network fast.\r\n\r\nA physical controller with multiple 1GbE and 10GbE ports in a rack mountable 1U form factor.\r\n3+1 clustering delivers up to 3,000 APs per cluster.\r\nConnect up to 60,000 clients, and support tunneled or local break-out user traffic.",
       "min": 3,
       "parent": "{3B87E9CA-ABD5-4269-BC52-220FCFA50029}",
       "pageId": "64225509",
       "label": "ResourceFacingServiceRuckusSmartZoneController"
     },
     {
       "type": "Resource Facing Service Specification",
       "id": "{C53F4E8A-213C-49a9-A4E4-DC0179158382}",
       "name": "Huawei  HG659",
       "description": "Vodafone wireless modem\r\n\r\nhttps://www.vodafone.co.nz/cms/documents/wirelessmodem-userguide.pdf",
       "min": 3,
       "parent": "{3B87E9CA-ABD5-4269-BC52-220FCFA50029}"
     }
   ]
   ,][0]
     var partySiteHierarchy =[[
     {
       "type": "Party",
       "id": "{64B4C39A-6D87-4fe7-91A1-2C9733051B37}",
       "name": "aParty",
       "description": "",
       "min": 1,
       "parent": "null"
     },
     {
       "type": "Customer Location",
       "id": "{EF3C711F-3FE1-4214-A181-5DAD7B84F868}",
       "name": "Christchurch",
       "description": "",
       "min": 2,
       "parent": "{64B4C39A-6D87-4fe7-91A1-2C9733051B37}"
     },
     {
       "type": "Customer Location",
       "id": "{D0481442-1174-471e-8B55-ADC55D709000}",
       "name": "Dunedin",
       "description": "",
       "min": 2,
       "parent": "{64B4C39A-6D87-4fe7-91A1-2C9733051B37}"
     }
   ]
   ,][0]
     var partyInterrelationships =JSON.parse(JSON.stringify(customerInterrelationships));

     partyHierarchy.forEach(newHierarchyReferences);
     partyDeviceHierarchy.forEach(newHierarchyReferences);
     partyCPEHierarchy.forEach(newHierarchyReferences);
     partySiteHierarchy.forEach(newHierarchyReferences);
     var partyServiceData =JSON.parse(JSON.stringify(serviceData));
     partyServiceData.forEach(newHierarchyReferences)
     partyInterrelationships.forEach(newMapReferences)
     var partyConstraints = JSON.parse(JSON.stringify(constraintsData));
     partyConstraints.forEach(newMapReferences);

     var userCustomerTransform = { name: "userCustomer",cx: 0.25*width, cy:height*0.1,anchor: "middle", style: "serviceUser", fixed: true };
     var userPartyTransform  = {name: "userParty", cx: width-0.25*width, cy:height*0.1,anchor:"middle", style: "serviceUser" , fixed: true}
     var deviceCustomerTransform = { name: "deviceCustomer",cx: 0.05*width, cy:height*0.1,anchor: "middle", style: "device" , fixed: true};
     var devicePartyTransform = { name: "deviceParty",cx: width-0.05*width, cy:height*0.1,anchor: "middle", style: "device" , fixed: true};
     var siteCustomerTransform = {name: "siteCustomer",cx: 0.25*width, cy:height*0.9,anchor:"middle" , style: "site", fixed: true}
     var sitePartyTransform = {name: "siteParty",cx: width-0.25*width, cy:height*0.9, anchor:"middle", style: "site", fixed: true}
     var cpeCustomerTransform = { name: "cpeCustomer",cx: 0.05*width, cy:height*0.3,anchor: "middle", style: "cpe" , fixed: true};
     var cpePartyTransform = { name: "cpeParty",cx: width-0.05*width, cy:height*0.3,anchor: "middle", style: "cpe" , fixed: true};
     var customerServiceTransform = {name: "customerService",cx: 0.1*width, cy:height*0.8,anchor: "middle",style: "service", fixed: false}
     var partyServiceTransform = {name: "partyService",cx: width-0.1*width, cy:height*0.8,anchor: "middle",style: "service" , fixed: false}

     var emergentConstraints = JSON.parse(JSON.stringify(emergentData));
     emergentConstraints.forEach(newCrossStackReferences);

     var userStack = {
       stackNumber: 0,
       stackName:  "customer",
       constraints: customerConstraints,
       layers: [ { name: "user",
           type: "User",
           components: customerHierarchy,
           transform: userCustomerTransform
         },{
           name: "device",
           type: "Device",
           components: customerDeviceHierarchy,
           transform: deviceCustomerTransform,
         },{
           name: "cpe",
           type: "CPE",
           components: customerCPEHierarchy,
           transform: cpeCustomerTransform,
         },
         {
           name: "site",
           type: "Site",
           components: customerSiteHierarchy,
           transform: siteCustomerTransform,
         },
         {
           name: "service",
           type: "Service",
           components: customerServiceData,
           dependencies: customerInterrelationships,
           transform: customerServiceTransform
         }
       ]
     };
     var partyStack = {
       stackNumber: 1,
       stackName: "party",
       constraints: partyConstraints,
       layers: [
       { name: "user",
         type: "User",
         components: partyHierarchy,
         transform: userPartyTransform
       },{
         name: "device",
         type: "Device",
         components: partyDeviceHierarchy,
         transform: devicePartyTransform
       },{
         name: "cpe",
         type: "CPE",
         components: partyCPEHierarchy,
         transform: cpePartyTransform
       },{
         name: "site",
         type: "Site",
         components: partySiteHierarchy,
         transform: sitePartyTransform
       },{
         name: "service",
         type: "Service",
         components: partyServiceData,
         dependencies: partyInterrelationships,
         transform: partyServiceTransform
       }]
     };

     //var stacks = [partyStack]
     var stacks = [userStack,partyStack]

     return { emergentConstraints, stacks };
   }

   var extensionId = "networkcore"
   var extension = { "id": extensionId };
   var extensionNode = { data: extension, fx: width/2, fy: height, fixed: true }
   function extensionFactory(node,nodeHash){
       if(node.data.name==='WAN Interconnect' && !nodeHash[extensionId]){
         return extensionNode;
       }
     return null;
   }

   function selectionFunction(n){
     return n.data.selected? true: false;
   }

   function crossStackLinkFactory(node1,node2){
        return { source: node2 , target: node1 }
   }

   function initialize(){
     var visualization = vis.createVisualization(createModel,{
       nodesize: 20,
       width: width,
       height: height
     });
     visualization.setSelectionFunction(selectionFunction);
     visualization.setExtensionFactory(extensionFactory);
     //visualization.setInterLayerLinkFactory(interLayerLinkFactory);
     visualization.setCrossStackLinkFactory(crossStackLinkFactory);
     visualization.render();
   }

   initialize();
   </script>

   <a name="About"/>
   <div class="panel panel-default">
      <div class="panel-heading">About</div>
     <div class="panel-body">
       This visualization presents layers of entities in various stacks.
     </div>
   </div>



</body>

</html>
